{% extends "base.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/mitre.css') }}" />

<a href="{{ url_for('routes.mitre_tactic', tactic=technique.tactic.replace(' ', '_')) }}">Back to {{ technique.tactic }}</a>


<h1>{{ technique.title }} [{{ technique.id }}]</h1>
<pre>
    <strong>Data Sources:</strong> {{ technique.data_sources }}
    <strong>Protocol:</strong> {{ technique.protocol }}
    <strong>OS:</strong> {{ technique.os }}
        <h2>Overview</h2>
    <strong>Objective:</strong> {{ technique.objective }}
    <strong>Scope:</strong> {{ technique.scope }}
    <strong>Threat Model:</strong> {{ technique.threat_model }}
</pre>

<h2>Hypothesis</h2>
<ul>
    {% for question in technique.hypothesis %}
    <li>{{ question }}</li>
    {% endfor %}
</ul>

<h2>Data Sources & Log Queries</h2>
<h3>üõ† Log Sources to Query</h3>
<pre>
    <table>
        <tr><th>Log Type</th><th>Source</th></tr>
        {% for log in technique.log_sources %}
        <tr><td>{{ log.type }}</td><td>{{ log.source }}</td></tr>
        {% endfor %}
    </table>
</pre>

<h3>üõ† Detection Methods</h3>
<pre>
    <ul>
        {% for method in technique.detection_methods %}
        <li>{{ method }}</li>
        {% endfor %}
    </ul>
</pre>

<h2>Hunting Queries</h2>
<h3>üîç SPL - Detect {{ technique.title }}</h3>
<pre>{{ technique.spl_query }}</pre>
<a href={{ technique.spl_rule }}>üîç SPL [{{ technique.id }}]</a>
<a href={{ technique.elastic_rule }}>üîç Elastic [{{ technique.id }}]</a>
<a href={{ technique.sigma_rule }}>üîç Sigma [{{ technique.id }}]</a>

<h2>3.1.5 Hunt Execution Steps</h2>
<pre>
    <ol>
        {% for step in technique.hunt_steps %}
        <li>{{ step }}</li>
        {% endfor %}
    </ol>
</pre>

<h2>Expected Outcomes</h2>
<ul>
    {% for outcome in technique.expected_outcomes %}
    <li>{{ outcome }}</li>
    {% endfor %}
</ul>

<h2>MITRE ATT&CK Mapping</h2>
<table>
    <tr><th>Tactic</th><th>Technique</th><th>Example</th></tr>
    {% for mapping in technique.mitre_mapping %}
    <tr><td>{{ mapping.tactic }}</td><td>{{ mapping.technique }}</td><td>{{ mapping.example }}</td></tr>
    {% endfor %}
</table>

<h2>Operationalization & Next Steps</h2>
<h3>üöÄ Watchlist & Alerting</h3>
<ul>
    {% for alert in technique.watchlist %}
    <li>{{ alert }}</li>
    {% endfor %}
</ul>

<h3>üìå Enhance Defenses</h3>
<ul>
    {% for defense in technique.enhancements %}
    <li>{{ defense }}</li>
    {% endfor %}
</ul>

<h2>Summary & Reporting</h2>
<ul>
    <li><strong>Summary of Findings:</strong> {{ technique.summary }}</li>
    <li><strong>Remediation Steps:</strong> {{ technique.remediation }}</li>
    <li><strong>Future Improvements:</strong> {{ technique.improvements }}</li>
</ul>

<a href="{{ url_for('routes.mitre_tactic', tactic=technique.tactic.replace(' ', '_')) }}">Back to {{ technique.tactic }}</a>
{% endblock %}