import random
import re


TIPS = [
    "ğŸš€ Be sure to check sysmon RuleName field for T-Codes"
    "ğŸ› ï¸ Investigate newly installed software that wasn't authorized by IT.",
    "ğŸ•µï¸â€â™‚ï¸ Look for rogue processes running with elevated privileges.",
    "ğŸŒ Monitor for unusual geolocation patterns in login attempts.",
    "ğŸ“ˆ Analyze network traffic for unexpected spikes during off-hours.",
    "ğŸ”— Check for changes in DNS configurations pointing to malicious servers.",
    "ğŸ‘¾ Look for executables disguised as common file types like `.doc.exe`.",
    "ğŸ“‚ Investigate files with unusual double extensions like `report.pdf.exe`.",
    "ğŸš¦ Monitor ICMP traffic for unexpected usage, often used in C2.",
    "ğŸ”§ Scan for unauthorized modifications to firewall configurations.",
    "ğŸ•’ Investigate scheduled tasks that trigger outside working hours.",
    "ğŸŒ Watch for connections to known threat actor infrastructure.",
    "ğŸ“œ Look for tampered audit logs, especially around the incident timeline.",
    "ğŸ”— Monitor changes to symbolic links or hard links on critical files.",
    "ğŸ“¤ Investigate large outbound data transfers to unknown domains.",
    "ğŸ›¡ï¸ Look for registry changes in startup or run keys.",
    "ğŸ“¡ Monitor DNS TXT record queries, which might be used for data exfiltration.",
    "ğŸ“ Check temp directories for unexpected executable files.",
    "ğŸ’¾ Look for removable media usage on high-security systems.",
    "ğŸ–¥ï¸ Monitor remote desktop sessions for unusual activity.",
    "ğŸ“¶ Watch for unusual patterns in Wi-Fi connections from endpoints.",
    "ğŸš€ Look for process injection techniques in legitimate binaries.",
    "ğŸ” Investigate binaries running directly from `Downloads` folders.",
    "ğŸ› ï¸ Review new service creations for suspicious patterns.",
    "ğŸ“œ Analyze event logs for sequences indicating privilege escalation.",
    "ğŸ”’ Track unusual access to encryption keys or keystores.",
    "ğŸ“Š Monitor changes in user account privileges or roles.",
    "ğŸŒ Review outbound HTTP POST requests for signs of exfiltration.",
    "ğŸ›¡ï¸ Scan for new PowerShell scripts in sensitive directories.",
    "ğŸ“‚ Look for altered timestamps on key system binaries.",
    "ğŸ“¡ Monitor inbound SSH connections from unknown IP addresses.",
    "ğŸ“¥ Investigate bulk email activity from user accounts.",
    "ğŸ”— Look for network shares with changed permissions.",
    "ğŸš¦ Track internal traffic for lateral movement across VLANs.",
    "ğŸ“‹ Analyze clipboard activity for copied sensitive data.",
    "ğŸ–‹ï¸ Examine document metadata for unexpected embedded payloads.",
    "ğŸ“ˆ Monitor CPU and RAM usage for resource-intensive attacks.",
    "ğŸ•µï¸â€â™‚ï¸ Check for unrecognized browser extensions on user systems.",
    "ğŸ”— Monitor SMB connections between unusual pairs of endpoints.",
    "ğŸ“‚ Investigate folders with an unusually large number of hidden files.",
    "ğŸ”§ Look for changes in application whitelisting policies.",
    "ğŸ“¶ Watch for rogue access points spoofing legitimate Wi-Fi networks.",
    "ğŸ–¥ï¸ Analyze usage of utilities like `certutil` or `powershell` for abuse.",
    "ğŸ“œ Search for anomalies in VPN connection patterns.",
    "ğŸš¦ Monitor TCP retransmissions for hidden data channels.",
    "ğŸ” Investigate suspicious `.lnk` files in commonly accessed directories.",
    "ğŸ“‚ Check for unauthorized mounts of external file systems.",
    "ğŸŒ Review HTTP request headers for automated browsing patterns.",
    "ğŸ“¡ Look for unauthorized use of tunneling protocols like SSH or RDP.",
    "ğŸ› ï¸ Investigate sandbox evasion techniques in malware samples.",
    "ğŸ’» Make sure your Host Agents are not disabled by the APT/Red Team.",
    "ğŸ›¡ï¸ Ensure EDR and antivirus solutions are actively monitoring all endpoints.",
    "ğŸ”’ Monitor for unusual attempts to disable or uninstall security agents.",
    "ğŸ“Š Know what type of logs you are receiving.",
    "ğŸ” Understand your log sources and validate their integrity.",
    "ğŸ“ˆ Ensure critical logs like authentication, network traffic, and process activity are being collected.",
    "ğŸ“§ Phishing is a common initial access attempt.",
    "ğŸ›‘ Train employees to recognize and report phishing emails promptly.",
    "ğŸ•µï¸â€â™€ï¸ Investigate email attachments or links for suspicious behavior.",
    "ğŸ‘½ Initial Access, Lateral Movement, and C2 are the easiest to catch.",
    "ğŸŒ Watch for strange connections to uncommon IPs or ports for C2 detection.",
    "ğŸ”— Track login patterns for signs of lateral movement across systems.",
    "ğŸ› ï¸ Create Alerts tailored to your APT.",
    "ğŸš¨ Develop rules based on TTPs of the threats your organization faces.",
    "ğŸ‘¾ Use known threat actor behavior as a baseline for detection.",
    "ğŸ” Look for multiple failed login attempts followed by a success.",
    "ğŸ‘¥ Monitor for the creation of suspicious or unusual accounts.",
    "ğŸ–‹ï¸ Keep an eye out for renamed files or sudden changes to file extensions.",
    "ğŸ›¡ï¸ Always investigate signs of persistence mechanisms like scheduled tasks or services.",
    "ğŸ” Check logs for lateral movement patterns within the network.",
    "ğŸ“‚ Look for data exfiltration attempts during off-hours.",
    "ğŸ•µï¸â€â™‚ï¸ Watch for processes running in uncommon directories.",
    "ğŸ—‚ï¸ Review changes to sensitive directories like /etc or C:\\Windows\\System32.",
    "âš ï¸ Be alert to PowerShell scripts with obfuscation or base64 encoding.",
    "ğŸ“¥ Investigate unusual inbound or outbound traffic patterns.",
    "ğŸ’» Track the execution of unknown binaries or scripts.",
    "ğŸ“Š Analyze event logs for sequences that indicate privilege escalation.",
    "ğŸŒ Monitor for connections to known malicious IPs or domains.",
    "ğŸ“ˆ Look for unusual spikes in network activity or CPU usage.",
    "ğŸ”‘ Check for default or weak passwords in critical accounts.",
    "ğŸ”— Watch for newly created symbolic links or junction points.",
    "ğŸ•’ Investigate task scheduler events outside of normal working hours.",
    "ğŸ“¦ Look for recently installed software that wasnâ€™t approved.",
    "ğŸ”“ Monitor for attempts to disable antivirus or EDR tools.",
    "ğŸ“œ Analyze browser history or bookmarks for connections to malicious sites.",
    "ğŸ“‚ Look for files with double extensions like `.exe.pdf`.",
    "ğŸ› ï¸ Check system startup items for unauthorized entries.",
    "ğŸ“¤ Investigate signs of data compression and outbound transfer.",
    "ğŸ‘€ Watch for registry modifications in persistence-related keys.",
    "ğŸ” Scan for unsigned drivers or DLLs in system directories.",
    "ğŸ“¡ Monitor DNS queries to unusual or high-risk domains.",
    "ğŸ’½ Look for rogue virtual machines or snapshots.",
    "ğŸ–¥ï¸ Inspect remote desktop protocol (RDP) logs for unauthorized connections.",
    "ğŸ›¡ï¸ Review firewall logs for changes in access rules or port scans.",
    "ğŸ“§ Analyze email headers for signs of phishing or spoofing.",
    "ğŸ“Œ Monitor USB activity for unauthorized devices.",
    "âš¡ Look for processes with high privilege levels started by unprivileged users.",
    "ğŸ”— Watch for changes to trusted system binaries.",
    "ğŸ› ï¸ Investigate event IDs related to new service installations.",
    "ğŸ“‚ Check shadow copies for deleted or modified files.",
    "ğŸ” Monitor account logins from unusual geographic locations.",
    "ğŸ“‚ Investigate tampering with backup files or schedules.",
    "ğŸ–¥ï¸ Look for signs of remote code execution (RCE) attempts.",
    "ğŸŒ Review web server logs for suspicious parameter tampering.",
    "ğŸš¦ Monitor network flows for unusual traffic patterns or unexpected ports.",
    "ğŸ“¡ Be suspicious of repeated DNS queries to non-existent domains.",
    "ğŸ”’ Check for unauthorized changes to file or folder permissions.",
    "ğŸ“¤ Look for encrypted or compressed outbound traffic to unknown hosts.",
    "âš™ï¸ Monitor changes in system startup configurations.",
    "ğŸ” Search for PowerShell scripts that include encoded commands.",
    "ğŸ“ Investigate files with zero-byte size in critical directories.",
    "ğŸ•’ Check for processes running at scheduled intervals outside business hours.",
    "ğŸ“ˆ Review performance metrics for sudden resource spikes.",
    "ğŸš€ Look for signs of process injection into legitimate applications.",
    "ğŸ’» Monitor for unauthorized changes to group memberships.",
    "ğŸ”— Watch for symbolic links pointing to unexpected locations.",
    "ğŸ” Examine email attachments for hidden macros or scripts.",
    "âš ï¸ Scan for privilege escalation techniques in event logs.",
    "ğŸ“¦ Look for unexpected or unsigned updates to software packages.",
    "ğŸ’¾ Review logs for signs of removable media usage.",
    "ğŸ–¥ï¸ Investigate unusual usage of command-line utilities like `netstat` or `ipconfig`.",
    "ğŸ“¤ Track unusual outbound connections to high-risk countries.",
    "ğŸ” Look for registry keys with suspicious auto-start entries.",
    "ğŸ”§ Investigate changes to WMI subscriptions or filters.",
    "ğŸ“Š Analyze account lockout patterns for brute-force attempts.",
    "ğŸ›¡ï¸ Monitor processes using suspicious parent-child relationships.",
    "ğŸ“¥ Investigate large file downloads from unusual IPs.",
    "âš¡ Check for unauthorized applications installed via package managers.",
    "ğŸ”— Look for SMB connections between unexpected hosts.",
    "ğŸ” Search for processes masquerading as system utilities.",
    "ğŸ–¥ï¸ Review logs for attempts to clear or disable event logging.",
    "ğŸ“‚ Look for hidden files in critical directories.",
    "ğŸš¦ Monitor outbound traffic for data transfers at odd hours.",
    "ğŸ”“ Check for unauthorized access to sensitive configuration files.",
    "ğŸ”§ Scan for unrecognized services or drivers in startup logs.",
    "ğŸŒ Review web application logs for unauthorized access attempts.",
    "ğŸ“œ Look for tampered audit logs or log file deletions.",
    "ğŸ’¡ Investigate systems with unusual uptime patterns.",
    "ğŸ•µï¸â€â™‚ï¸ Monitor unusual changes to group policies.",
    "ğŸ“‚ Investigate abnormal growth in specific file directories.",
    "ğŸ› ï¸ Look for unusual process execution chains in forensic tools.",
    "ğŸ“‹ Check for clipboard monitoring or keylogging behavior.",
    "ğŸš¨ Monitor IDS/IPS alerts for common lateral movement patterns.",
    "ğŸŒ Correlate login activity with geolocation inconsistencies.",
    "ğŸ”‘ Investigate processes accessing security-critical files.",
    "ğŸ“¤ Look for repeated failed data upload attempts to unknown servers.",
    "ğŸ” Check for malicious scheduled tasks created recently.",
    "ğŸ›¡ï¸ Watch for unusual changes to user password policies.",
    "ğŸ“ˆ Investigate sudden changes in user account activity levels.",
    "ğŸ–¥ï¸ Review temporary files for evidence of script execution.",
    "ğŸ“¦ Monitor endpoints for unauthorized package or library downloads.",
    "ğŸ“‚ Look for anomalies in recently accessed files.",
    "âš™ï¸ Investigate mismatches in user-agent strings in web traffic.",
    "ğŸ” Look for attackers leaving test artifacts like `1.txt` or `test.ps1`.",
    "ğŸ“œ Track file hashes for unauthorized changes to key binaries.",
    "ğŸš¦ Review network traffic for abnormal TTL values.",
    "ğŸ›¡ï¸ Identify rare parent-child process relationships in your environment.",
    "ğŸ” Investigate long-running processes, especially with elevated privileges.",
    "ğŸ“Š Analyze PowerShell logs for encoded or obfuscated commands.",
    "ğŸŒ Review TLS/SSL traffic for connections to self-signed certificates.",
    "ğŸ“ Monitor for temporary files with sensitive data remnants.",
    "ğŸš¦ Analyze unusual ICMP traffic patterns, often used in C2 communications.",
    "ğŸ”— Watch for new shares created on file servers.",
    "ğŸ•µï¸â€â™‚ï¸ Search for suspicious DNS TXT record queries.",
    "ğŸ” Investigate commands executed by `cmd.exe` or `bash`.",
    "ğŸ–¥ï¸ Look for abnormal usage of tools like `certutil` or `wget`.",
    "ğŸ”“ Monitor for attempted privilege escalation via sudo or su.",
    "ğŸ“‚ Search for files with names mimicking system executables.",
    "ğŸš¨ Look for multiple simultaneous logins to a single account.",
    "ğŸ›¡ï¸ Track binaries executed directly from the browser download folder.",
    "ğŸŒ Monitor HTTP POST requests to unknown domains.",
    "ğŸ“Š Analyze VPN connections for anomalies in duration or frequency.",
    "ğŸ” Check for DLLs loaded from unexpected directories.",
    "ğŸ“‚ Monitor `.tmp` files in system directories.",
    "ğŸ–‹ï¸ Look for encoded payloads in commonly abused file formats like `.docx`.",
    "ğŸš¦ Watch for network traffic containing known C2 patterns.",
    "ğŸ”§ Investigate changes to Local Security Authority (LSA) configuration.",
    "ğŸ“ˆ Analyze system uptime for anomalies indicating potential reboots.",
    "ğŸŒ Monitor unusual redirects in web server logs.",
    "ğŸ“‚ Investigate changes to `/etc/passwd` or SAM files.",
    "ğŸ›¡ï¸ Look for unauthorized modifications to PAM modules.",
    "ğŸ–‹ï¸ Examine email forwarding rules set by attackers for persistence.",
    "ğŸš¦ Analyze protocol mismatches in encrypted traffic.",
    "ğŸ” Search for executables or scripts hidden with spaces or special characters.",
    "ğŸ“‚ Look for ZIP/RAR archives with embedded malicious scripts.",
    "ğŸŒ Monitor user-agent strings for indicators of automation.",
    "ğŸš¦ Watch for port scanning or unusual sequential connections.",
    "ğŸ”’ Track processes that directly modify system logs.",
    "ğŸ“‚ Monitor suspicious changes to file ownership or permissions.",
    "ğŸ›¡ï¸ Investigate suspicious network shares with modified permissions.",
    "ğŸš€ Look for scripts invoking unauthorized API calls.",
    "ğŸ”§ Monitor changes to firewall rules allowing external access.",
    "ğŸŒ Correlate suspicious geolocation patterns in remote logins.",
    "ğŸ–¥ï¸ Analyze command history for unusual usage.",
    "ğŸ“¤ Watch for data egress in unconventional formats.",
    "ğŸ“Š Investigate mismatches between file metadata and actual content.",
    "ğŸ” Search for execution of commands like `nc` or `netcat`.",
    "ğŸš¨ Track endpoints with repeated failed DNS lookups.",
    "ğŸ“‚ Monitor files compressed using password protection.",
    "ğŸ“¡ Look for inbound SSH connections from unknown sources.",
    "ğŸ–‹ï¸ Investigate office documents with unusual macros.",
    "ğŸš¦ Watch for packet size anomalies in encrypted traffic.",
    "ğŸ” Analyze event logs for attempts to tamper with security settings.",
    "ğŸ›¡ï¸ Monitor software installations from untrusted certificates.",
    "ğŸ“¥ Investigate repeated connections to IPs without associated domains.",
    "ğŸ“Š Look for binary downloads from suspicious URLs.",
    "ğŸ•µï¸â€â™‚ï¸ Monitor registry changes related to persistence mechanisms.",
    "ğŸ› ï¸ Analyze anomalous changes in group memberships.",
    "ğŸ“‚ Investigate tampered antivirus exclusions or policies.",
    "ğŸ“ˆ Search for inconsistencies in time-stamped files.",
    "ğŸ”§ Monitor default admin shares for unusual access.",
    "ğŸ“œ Look for signs of log tampering in security audit logs.",
    "ğŸ“¡ Check SMB traffic for unauthorized access attempts.",
    "ğŸ–‹ï¸ Investigate PDFs with hidden payloads or JavaScript.",
    "ğŸŒ Analyze web server headers for outdated or misconfigured software.",
    "ğŸ“Š Look for modified or unexpected system images.",
    "ğŸ–¥ï¸ Monitor endpoint connections to public paste sites.",
    "ğŸš¦ Watch for stealthy TCP retransmissions in packet captures.",
    "ğŸ“‚ Investigate newly created service accounts with high privileges.",
    "ğŸ”§ Analyze processes creating non-standard network connections.",
    "ğŸ“ˆ Monitor CPU and memory spikes during off-hours.",
    "ğŸš€ Investigate scripts executed from uncommon locations.",
    "ğŸŒ Correlate network traffic against threat intelligence sources.",
    "ğŸ“¤ Look for encrypted or compressed outbound data at odd times.",
    "ğŸ“‚ Monitor endpoints for large, unexpected file deletions.",
    "ğŸ“¡ Look for reverse shell attempts in network logs.",
    "ğŸ›¡ï¸ Investigate unusual browser plugins or extensions.",
    "ğŸ“Š Search for unexplained registry run keys.",
    "ğŸ”§ Investigate unusual file naming conventions in backup locations.",
    "ğŸ–¥ï¸ Monitor desktop activity for unscheduled screenshots or keylogging.",
    "ğŸ“œ Investigate systems with missing or altered critical files.",
    "ğŸš¦ Correlate failed authentications with brute-force patterns.",
    "ğŸ“‚ Analyze temporary folders for suspicious script files.",
    "ğŸ” Look for attackers testing connectivity via `ping` or traceroute.",
    "ğŸ“Š Track spikes in file-sharing activity.",
    "ğŸŒ Review web traffic logs for possible data leakage.",
    "ğŸ–‹ï¸ Investigate documents with high entropy in their metadata.",
    "ğŸ“¤ Look for staging directories with suspicious files.",
    "ğŸ•µï¸â€â™‚ï¸ Monitor access logs for unauthorized application startups.",
    "ğŸ“‚ Investigate tampered scheduled jobs or cron entries.",
    "ğŸ›¡ï¸ Analyze unauthorized password resets or account creations.",
    "ğŸ”§ Search for hidden tasks in task scheduler or cron jobs.",
    "ğŸ“¡ Investigate unusual or repeated ARP requests.",
    "ğŸŒ Correlate IoT device traffic patterns with known exploits.",
    "ğŸš¦ Monitor DNS requests with large or binary-like payloads.",
    "ğŸ“ˆ Look for repeated HTTP 401 (Unauthorized) responses."
]

# Cybersecurity jokes
JOKES = [
    "ğŸ¤– Why did the hacker cross the road? To get to the other .NET.",
    "â„ï¸ Why was the computer cold? It left its Windows open.",
    "ğŸª¥ How do hackers freshen their breath? With CyberTic Tac!",
    "â¤ï¸â€ğŸ©¹ Why don't hackers ever get into relationships? They're afraid of commitments.",
    "ğŸ¾ What do you call a hacker who loves animals? A purr-sistence threat!",
    "ğŸ’¸ Why did the server go broke? It lost all its cache.",
    "ğŸ˜‚ How do you make a malware laugh? Give it a worm joke!",
    "ğŸ“‰ Why did the sysadmin go broke? Too many root expenses.",
    "ğŸ¥£ Whatâ€™s a hackerâ€™s favorite kind of cereal? Spy-ders!",
    "ğŸ›¡ï¸ Why did the password break up with the hacker? It was too weak.",
    "ğŸ”’ Why are cybersecurity experts bad at telling jokes? They always encrypt the punchline.",
    "ğŸµ Whatâ€™s a hackerâ€™s favorite music genre? Phishing!",
    "ğŸ‘“ Why do hackers wear glasses? Because they lost their focus.",
    "ğŸ“¶ Why did the WiFi break up with the laptop? It found a stronger connection.",
    "ğŸ˜Œ Why was the antivirus program so relaxed? It knew how to quarantine stress.",
    "ğŸ Whatâ€™s a hackerâ€™s favorite season? Phall.",
    "ğŸŒ‘ Why do programmers prefer dark mode? Because light attracts bugs.",
    "ğŸš© Whatâ€™s a hackerâ€™s favorite game? Capture the flag!",
    "â˜ ï¸ Why donâ€™t hackers get along with pirates? Too many patches.",
    "ğŸ‰ How do you throw a cybersecurity party? Invite everyone to the LAN!",
    "ğŸ”¥ Why was the firewall so happy? It finally blocked its ex.",
    "ğŸ”‘ Why was the keyboard locked out of the server room? Too many CAPS.",
    "ğŸº Whatâ€™s a hackerâ€™s least favorite drink? Root beer.",
    "âš¾ Why was the hacker bad at baseball? It couldnâ€™t handle the curve (encryption).",
    "â˜• How do cybersecurity experts like their coffee? Encrypted.",
    "ğŸ˜­ Why did the antivirus cry? It couldnâ€™t handle the worm.",
    "ğŸ¤« Why donâ€™t hackers tell secrets? Theyâ€™re worried about key-loggers.",
    "ğŸ•ï¸ Why donâ€™t hackers go camping? Too many phishing attacks.",
    "ğŸ’ƒ Whatâ€™s a hackerâ€™s favorite dance? The worm.",
    "ğŸ´ Why was the Trojan horse so good at infiltration? It always had the â€˜writeâ€™ access.",
    "ğŸ§— Whatâ€™s the cybersecurity expertâ€™s favorite sport? Fire-wall climbing.",
    "ğŸ•µï¸â€â™‚ï¸ Why was the hacker great at hide-and-seek? It always hid in the registry.",
    "ğŸ›œ What did the router say to the server? Youâ€™ve got the bandwidth for this!",
    "ğŸ½ï¸ Whatâ€™s a phishing scammerâ€™s favorite dish? Spam.",
    "ğŸŒ Why donâ€™t hackers get sunburned? They stay in the shadows.",
    "ğŸ§‘â€ğŸ”¬ What do you call a group of math and science geeks at a party? Social engineers.",
    "ğŸŒ Whatâ€™s the best way to catch a runaway robot? Use a botnet.",
    "ğŸ› Why did the programmer leave the camping trip early? There were too many bugs."
]

TCODES = [
    "ğŸ›¡ï¸ T1003: Credential Dumping - Monitor for attempts to access LSASS or SAM files to extract credentials.",
    "ğŸ“œ T1021: Remote Services - Review logs for suspicious RDP or SSH connections from unknown sources.",
    "ğŸ” T1059: Command and Scripting Interpreter - Look for PowerShell, bash, or Python commands running unusual scripts.",
    "ğŸ–¥ï¸ T1078: Valid Accounts - Check for legitimate credentials being used in unusual ways, such as geographic anomalies.",
    "ğŸ“‚ T1105: Ingress Tool Transfer - Investigate downloads of suspicious files from external IPs.",
    "ğŸš¦ T1071: Application Layer Protocol - Monitor for unexpected use of protocols like HTTP or DNS for command and control.",
    "ğŸ“¡ T1136: Create Account - Look for unauthorized user account creation on critical systems.",
    "ğŸ› ï¸ T1566: Phishing - Analyze email headers and attachments for signs of phishing attempts.",
    "ğŸ”§ T1113: Screen Capture - Investigate processes accessing screen-capturing APIs or creating screenshots.",
    "ğŸ“Š T1046: Network Service Scanning - Track scans for open ports or services from internal or external sources.",
    "ğŸ“¤ T1041: Exfiltration Over C2 Channel - Monitor encrypted outbound traffic for unusual data size or frequency.",
    "ğŸ” T1218: Signed Binary Proxy Execution - Look for legitimate binaries like msbuild.exe or regsvr32.exe being used for execution.",
    "ğŸ“ˆ T1053: Scheduled Task/Job - Review task scheduler logs for new or altered tasks.",
    "ğŸ“‚ T1106: Execution via API - Look for applications calling APIs like CreateProcess or ShellExecute suspiciously.",
    "ğŸ›¡ï¸ T1055: Process Injection - Monitor for signs of one process injecting code into another, such as DLL injection.",
    "ğŸ“œ T1562: Impair Defenses - Look for attempts to disable antivirus, EDR, or firewalls.",
    "ğŸ•µï¸ T1082: System Information Discovery - Check for commands like systeminfo or uname executed by unrecognized users.",
    "ğŸŒ T1203: Exploitation for Client Execution - Review crash or error logs for signs of exploitation attempts.",
    "ğŸ”— T1098: Account Manipulation - Look for changes to user accounts, such as password resets or role changes.",
    "ğŸ“‚ T1547: Boot or Logon Autostart Execution - Monitor registry keys and startup folders for new entries.",
    "ğŸ” T1210: Exploitation of Remote Services - Look for brute force or vulnerability exploitation on RDP, SMB, or SSH.",
    "ğŸ“¡ T1571: Non-Standard Port - Monitor traffic on uncommon ports used for potential C2 communication.",
    "ğŸš¦ T1573: Encrypted Channel - Analyze TLS traffic to detect abnormal certificate usage or destinations.",
    "ğŸ“‹ T1543: Create or Modify System Process - Investigate creation of new services or changes to existing ones.",
    "ğŸ–¥ï¸ T1008: Fallback Channels - Look for changes in traffic patterns during primary C2 disruption.",
    "ğŸ”’ T1217: Browser Credential Theft - Check for access to browser profile directories or credential stores.",
    "ğŸ“¤ T1048: Exfiltration Over Alternative Protocol - Monitor file uploads using FTP, SCP, or similar tools.",
    "ğŸ› ï¸ T1056: Input Capture - Look for keylogger activity or suspicious hooks into input APIs.",
    "ğŸ“Š T1016: System Network Configuration Discovery - Track execution of ipconfig, ifconfig, or network enumeration tools.",
    "ğŸš¨ T1129: Shared Module - Monitor shared libraries or modules loaded from unexpected paths.",
    "ğŸ“Š T1083: File and Directory Discovery - Investigate processes enumerating sensitive files or directories.",
    "ğŸ“¦ T1095: Non-Application Layer Protocol - Check for unusual protocols used for data exfiltration.",
    "ğŸ“œ T1027: Obfuscated Files or Information - Look for scripts or files with unusual encoding or compression.",
    "ğŸ›¡ï¸ T1107: File Deletion - Monitor for tools or commands used to delete logs or forensic evidence.",
    "ğŸ”§ T1070: Indicator Removal on Host - Investigate tampering with logs, disabling of EDR, or clearing event logs.",
    "ğŸ“‹ T1010: Application Window Discovery - Look for processes querying open window titles or processes.",
    "ğŸ“‚ T1050: New Service - Investigate the creation of new services as a persistence mechanism.",
    "ğŸš¦ T1134: Access Token Manipulation - Detect unusual impersonation or privilege escalation via tokens.",
    "ğŸŒ T1204: User Execution - Monitor for users executing attachments, scripts, or software directly from emails.",
    "ğŸ”‘ T1176: Browser Extensions - Investigate unauthorized or malicious extensions added to browsers.",
    "ğŸ”§ T1074: Data Staged - Check for large volumes of data being staged in temporary directories.",
    "ğŸ“¤ T1560: Archive Collected Data - Look for compressed files being prepared for exfiltration.",
    "ğŸ–‹ï¸ T1486: Data Encrypted for Impact - Monitor for ransomware-like encryption of files.",
    "ğŸ•µï¸ T1057: Process Discovery - Investigate commands or tools listing running processes.",
    "ğŸ“ T1132: Data Encoding - Check for unusual base64, hex, or XOR encoding in files or logs.",
    "ğŸ“¦ T1102: Web Service - Look for suspicious use of cloud services for C2 or exfiltration.",
    "ğŸ› ï¸ T1059.001: PowerShell - Analyze PowerShell logs for unusual or obfuscated commands.",
    "ğŸ“ˆ T1049: System Network Connections Discovery - Investigate commands like netstat or scripts enumerating network connections.",
    "ğŸ“‚ T1216: Signed Scripts - Check for scripts signed by trusted certificates but used maliciously.",
    "ğŸŒ T1104: Multi-Stage Channels - Monitor traffic for multiple hops or relays indicative of advanced attacks.",
    "ğŸ” T1555: Credentials from Password Stores - Investigate access to password managers or browser-stored credentials.",
    "ğŸ“¤ T1074.001: Remote Data Staging - Look for large data collections transferred to external hosts.",
    "ğŸ”§ T1574: Hijack Execution Flow - Check for modifications in binary execution flow like DLL search order hijacking.",
    "ğŸ”’ T1080: Taint Shared Content - Monitor for tampered shared files or directories in collaborative environments.",
    "ğŸ“ˆ T1090: Proxy - Investigate unexpected use of VPNs or anonymization tools.",
    "ğŸ–‹ï¸ T1497: Virtualization/Sandbox Evasion - Detect attempts to identify and evade virtualized or sandboxed environments.",
    "ğŸš¦ T1108: Redundant Access - Monitor for backdoor creation or redundant persistence mechanisms.",
    "ğŸ“œ T1485: Data Destruction - Track attempts to overwrite or corrupt critical files.",
    "ğŸ“‚ T1542: Pre-OS Boot - Investigate bootkits or changes to boot configurations.",
    "ğŸ“¡ T1558: Steal or Forge Kerberos Tickets - Look for tools like Mimikatz accessing Kerberos tickets.",
    "ğŸ”— T1020: Automated Exfiltration - Monitor scripted data transfers to external servers.",
    "ğŸ“¥ T1123: Audio Capture - Check for processes accessing audio devices without user consent.",
    "ğŸ› ï¸ T1570: Lateral Tool Transfer - Look for file transfers to other hosts via SMB, SCP, or similar protocols.",
    "ğŸ“¤ T1040: Network Sniffing - Detect unauthorized packet capture or network monitoring tools.",
    "ğŸ”§ T1052: Exfiltration Over Physical Medium - Investigate large file transfers to USB drives or other external media.",
    "ğŸ” T1052.001: Exfiltration Over Bluetooth - Monitor Bluetooth activity for unexpected file transfers.",
    "ğŸŒ T1018: Remote System Discovery - Investigate attempts to enumerate network-connected devices.",
    "ğŸ“‚ T1484: Domain Policy Modification - Check for changes to group policies or domain configurations.",
    "ğŸ”’ T1548: Abuse Elevation Control Mechanism - Look for processes bypassing UAC or sudo permissions.",
    "ğŸ“œ T1552: Unsecured Credentials - Investigate plaintext or weakly protected credentials in configuration files.",
    "ğŸ–¥ï¸ T1546: Event Triggered Execution - Monitor for unusual triggers tied to task scheduling or logon events.",
    "ğŸ“¥ T1125: Video Capture - Look for processes using webcam APIs or recording software.",
    "ğŸ”§ T1012: Query Registry - Investigate registry queries for persistence-related keys.",
    "ğŸ“ˆ T1018: System Network Connections Discovery - Look for reconnaissance attempts enumerating active connections.",
    "ğŸ“‚ T1120: Peripheral Device Discovery - Check logs for unexpected enumeration of hardware devices.",
    "ğŸ›¡ï¸ T1036: Masquerading - Detect renamed executables mimicking legitimate system files.",
    "ğŸš¦ T1048: Exfiltration Over Alternative Protocol - Monitor FTP, SCP, or non-standard protocols for data transfer.",
    "ğŸ“¦ T1074.002: Local Data Staging - Investigate large files being prepared in temporary directories.",
    "ğŸ”— T1021.001: Remote Desktop Protocol - Review RDP logs for unusual connection patterns.",
    "ğŸ“¡ T1553: Subvert Trust Controls - Monitor attempts to bypass or forge trust certificates.",
    "ğŸ“¥ T1039: Data from Network Shared Drive - Look for unauthorized access to shared drives.",
    "ğŸ”§ T1033: System Owner/User Discovery - Investigate processes attempting to identify logged-in users.",
    "ğŸ“‚ T1552.004: Container Credential Dumping - Monitor container runtime logs for credential access attempts.",
    "ğŸ” T1568: Dynamic Resolution - Investigate use of domain generation algorithms or DNS tunneling for C2.",
    "ğŸ–‹ï¸ T1134.003: Token Impersonation/Theft - Detect impersonation of user tokens for privilege escalation.",
    "ğŸ“œ T1014: Rootkit - Look for signs of kernel module tampering or hidden processes.",
    "ğŸ“¤ T1089: Disabling Security Tools - Track attempts to disable security tools via registry edits or system commands.",
    "ğŸ”’ T1087: Account Discovery - Investigate attempts to enumerate user accounts in local or domain environments."
]

ANSI_ESCAPE_REGEX = re.compile(r'\x1B(?:[@-Z\\-_]|\[[0-?]*[ -/]*[@-~])')
TCODE_PATTERN = re.compile(r'(T\d{4}(\.\d{3})?)')  # Matches T#### or T####.###

def get_random_tip_or_joke(clean=False):
    # Pick a random tip or joke
    item = random.choice(TIPS + JOKES + TCODES)
    
    # Replace T-Codes with clickable links
    def replace_tcode_with_link(match):
        tcode = match.group(1)
        return f'<a href="https://attack.mitre.org/techniques/{tcode}/" target="_blank">{tcode}</a>'
    
    formatted_item = TCODE_PATTERN.sub(replace_tcode_with_link, item)

    if clean:
        # Remove HTML tags for clean output
        formatted_item = re.sub(r'<[^>]+>', '', formatted_item)
    
    return formatted_item